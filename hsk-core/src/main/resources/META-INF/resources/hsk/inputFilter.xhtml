<?xml version="1.0" encoding="UTF-8"?>
<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:cc="http://java.sun.com/jsf/composite"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
     xmlns:h="http://xmlns.jcp.org/jsf/html">
    <cc:interface>
        <cc:attribute name="value" type="com.hiska.result.Filter"/>
        <cc:attribute name="label"/>
        <cc:attribute name="title"/>
        <cc:attribute name="alt"/>
        <cc:attribute name="styleClass"/>
        <cc:attribute name="disabled" type="java.lang.Boolean" default="false"/>
        <cc:attribute name="converter" default="javax.faces.String"/>
        <cc:attribute name="withNull" type="java.lang.Boolean" default="false"/>
        <cc:attribute name="withIneq" type="java.lang.Boolean" default="false"/>
        <cc:attribute name="items"/>
        <cc:attribute name="update" default="#{cc.clientId}"/>
    </cc:interface>
    <cc:implementation>
        <div id="#{cc.clientId}" class="hsk-input-filter">
            <c:set target="#{cc.attrs}" property="value" value="#{_help.createFilterValue(cc.attrs.value)}"/>
            <c:set target="#{cc.attrs}" property="items" value="#{_help.createItemsValue(cc.attrs.converter, cc.attrs.items, cc.attrs.withNull, cc.attrs.withIneq)}"/>
            <div class="input-group input-group-sm">
                <h:selectOneMenu value="#{cc.attrs.value.expr}"
                                 title="Fitlrar Campo '#{cc.attrs.label}'"
                                 disabled="#{cc.attrs.disabled}"
                                 styleClass="filter-eq form-control form-control-sm">
                    <f:selectItems value="#{cc.attrs.items}"/>
                    <f:ajax event="change"
                            render="#{cc.attrs.update}"
                            immediate="true"/>
                </h:selectOneMenu>
                <h:inputText value="#{cc.attrs.value.value}" 
                             rendered="#{cc.attrs.value.withValue}"
                             disabled="#{cc.attrs.disabled}"
                             label="#{cc.attrs.label}"
                             title="Valor '#{cc.attrs.label}'"
                             styleClass="form-control form-control-sm">
                    <f:converter converterId="#{cc.attrs.converter}"/>
                </h:inputText>
                <h:inputText value="#{cc.attrs.value.other}" 
                             rendered="#{cc.attrs.value.withOther}"
                             disabled="#{cc.attrs.disabled}"
                             label="#{cc.attrs.label}"
                             title="Valor '#{cc.attrs.label}'"
                             styleClass="form-control form-control-sm">
                    <f:converter converterId="#{cc.attrs.converter}"/>
                </h:inputText>
                <h:commandLink styleClass="btn btn-sm btn-danger"
                               rendered="#{!cc.attrs.value.ignore}"
                               disabled="#{cc.attrs.disabled}"
                               title="Quitar '#{cc.attrs.label}'">
                    <span class="fa fa-lg fa-times"></span>
                    <f:ajax event="action" 
                            render="#{cc.attrs.update}"
                            immediate="true"/>
                    <f:setPropertyActionListener target="#{cc.attrs.value}"
                                                 value="#{null}"/>
                </h:commandLink>
            </div>
        </div>
    </cc:implementation>
</div>
